<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Checkout • POS</title>

  <link href="https://fonts.googleapis.com/css2?family=DM+Sans:wght@400;600;700&display=swap" rel="stylesheet">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css" rel="stylesheet">

  <style>
    body { font-family: "DM Sans", sans-serif; background: #f8f9fb; }
    .card { border-radius: 12px; }
    .section-title { font-weight: 700; font-size: 1.05rem; }
    .summary-line { display:flex; justify-content:space-between; margin:.3rem 0; }
    .summary-line.total { font-size:1.1rem; font-weight:700; }
    .chip { border:1px solid #ccc; border-radius:50px; padding:6px 10px; cursor:pointer; }
    .chip.active { background:#0d6efd; color:#fff; border-color:#0d6efd; }
    .list-img { width:48px; height:48px; border-radius:8px; object-fit:cover; }
    .sticky-cta { position: sticky; bottom: 0; z-index: 10; background: #fff; border-top:1px solid #eee; padding:.75rem; }
  </style>
</head>
<body>
  <div class="container my-3">
    <h4 class="fw-bold mb-3"><i class="bi bi-basket2 text-primary"></i> Checkout</h4>

    <!-- Order Summary -->
    <div class="card shadow-sm mb-3">
      <div class="card-body">
        <div class="section-title mb-2">Your Items</div>
        <div id="itemsList"></div>
        <hr>
        <div class="summary-line"><span>Subtotal</span><span id="sumSubtotal">₹0</span></div>
        <div class="summary-line"><span>GST (5%)</span><span id="sumGST">₹0</span></div>
        <div class="summary-line total"><span>Total</span><span id="sumTotal">₹0</span></div>
      </div>
    </div>

    <!-- Customer Info -->
    <div class="card shadow-sm mb-3">
      <div class="card-body">
        <div class="section-title mb-2">Customer Details</div>
        <div class="row g-2">
          <div class="col-md-6">
            <label class="form-label">Name</label>
            <input type="text" id="custName" class="form-control" placeholder="Enter name">
          </div>
          <div class="col-md-6">
            <label class="form-label">Mobile</label>
            <input type="text" id="custPhone" class="form-control" placeholder="10-digit number">
          </div>
        </div>
      </div>
    </div>

    <!-- Payment -->
    <div class="card shadow-sm mb-3">
      <div class="card-body">
        <div class="section-title mb-2">Payment Method</div>
        <div class="d-flex gap-2 flex-wrap">
          <span class="chip active" data-pay="cash">Cash</span>
          <span class="chip" data-pay="upi">UPI</span>
          <span class="chip" data-pay="card">Card</span>
        </div>
      </div>
    </div>

    <!-- CTA -->
    <div class="sticky-cta">
      <button id="placeOrder" class="btn btn-primary w-100 btn-lg">
        <i class="bi bi-check2-circle me-1"></i> Place Order
      </button>
    </div>
  </div>

  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
  <script>
    /* ✅ Default cart with 2 items pre-added */
    let cart = {
      1: { id: 1, name: "Margherita Pizza", price: 199, qty: 1, img: "https://picsum.photos/seed/p1/100" },
      2: { id: 2, name: "Cold Coffee",     price: 120, qty: 2, img: "https://picsum.photos/seed/p2/100" },
    };

    const cur = n => "₹" + n.toFixed(2);
    let paymentMethod = 'cash';

    function renderCart() {
      const list = document.getElementById("itemsList");
      const items = Object.values(cart);
      let subtotal = 0;
      items.forEach(i => subtotal += i.price * i.qty);
      const gst = subtotal * 0.05;
      const total = subtotal + gst;

      document.getElementById("sumSubtotal").textContent = cur(subtotal);
      document.getElementById("sumGST").textContent = cur(gst);
      document.getElementById("sumTotal").textContent = cur(total);

      list.innerHTML = items.map(it => `
        <div class="d-flex align-items-center justify-content-between py-2 border-bottom">
          <div class="d-flex align-items-center gap-2">
            <img src="${it.img}" class="list-img" alt="${it.name}">
            <div>
              <div class="fw-semibold">${it.name}</div>
              <div class="small text-secondary">x${it.qty} • ${cur(it.price)}</div>
            </div>
          </div>
          <div>${cur(it.price * it.qty)}</div>
        </div>
      `).join('');
    }

    renderCart();

    /* Payment selection */
    document.querySelectorAll("[data-pay]").forEach(chip => {
      chip.addEventListener("click", () => {
        document.querySelectorAll("[data-pay]").forEach(c => c.classList.remove("active"));
        chip.classList.add("active");
        paymentMethod = chip.dataset.pay;
      });
    });

    /* Place order */
    document.getElementById("placeOrder").addEventListener("click", () => {
      const name = document.getElementById("custName").value.trim();
      const phone = document.getElementById("custPhone").value.trim();

      if (!name) return alert("Please enter customer name");
      if (!/^\d{10}$/.test(phone)) return alert("Please enter valid 10-digit mobile number");

      const payload = {
        customer: { name, phone },
        payment_method: paymentMethod,
        cart: Object.values(cart),
        amounts: {
          subtotal: Object.values(cart).reduce((s,i)=>s+i.qty*i.price, 0),
          gst_rate: 0.05
        },
        created_at: new Date().toISOString(),
      };

      alert("✅ Order placed successfully!\n\n" + JSON.stringify(payload, null, 2));
    });
  </script>
</body>
</html>
